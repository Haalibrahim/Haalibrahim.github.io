---
title: "Titanic Case Analysis "
date: 2020-03-15
tags: [data wrangling, data science, messy data]
header:
excerpt: "Data Wrangling, Data Science, Messy Data"
mathjax: "true"
---


# Titanic: Machine Learning from Disaster

### Predict survival on the Titanic
- Defining the problem statement
- Collecting the data
- Exploratory data analysis
- Feature engineering
- Modelling
- Testing

# 1. Defining the problem statement:

Conducting an analysis on predicting the sort of people who were likely to survive. We are going to apply the tools of machine learning to predict which passengers survivied the tragedy


```python
from IPython.display import Image
Image(url= "https://static1.squarespace.com/static/5006453fe4b09ef2252ba068/5095eabce4b06cb305058603/5095eabce4b02d37bef4c24c/1352002236895/100_anniversary_titanic_sinking_by_esai8mellows-d4xbme8.jpg")
```




<img src="https://static1.squarespace.com/static/5006453fe4b09ef2252ba068/5095eabce4b06cb305058603/5095eabce4b02d37bef4c24c/1352002236895/100_anniversary_titanic_sinking_by_esai8mellows-d4xbme8.jpg"/>



# 2. Collecting the Data:

The data comes from Kaggle, they are providing us with training and testing set. link to the data is found on my github: https://github.com/Haalibrahim/Titanic-case-study

### Load libraries, train and test data


```python
#Import Libraries
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
sns.set()
```


```python
plt.style.use('fivethirtyeight')
import warnings
warnings.filterwarnings('ignore')
%matplotlib inline
```


```python
train=pd.read_csv('train.csv')
test=pd.read_csv('test.csv')
```

# 3. Exploratory data analysis:

### Data Dictionary:
- Survived: 0 = No, 1= Yes
- Pclass: Ticket class 1 = 1st, 2= 2nd, 3 = 3rd
- Sibsp: Number of siblings / spouses aboard the titanic
- Parch: Number of parents/ childern abroad the titanic
- Ticket: Ticket number
- Fare: price of the ticket
- Cabin: Number of the Cabin
- Embarked: Port of Embarkation, C= Cherbourg , Q= Queenstown, S= Southhampton


```python
train.head(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>5</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>Moran, Mr. James</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>330877</td>
      <td>8.4583</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <td>6</td>
      <td>7</td>
      <td>0</td>
      <td>1</td>
      <td>McCarthy, Mr. Timothy J</td>
      <td>male</td>
      <td>54.0</td>
      <td>0</td>
      <td>0</td>
      <td>17463</td>
      <td>51.8625</td>
      <td>E46</td>
      <td>S</td>
    </tr>
    <tr>
      <td>7</td>
      <td>8</td>
      <td>0</td>
      <td>3</td>
      <td>Palsson, Master. Gosta Leonard</td>
      <td>male</td>
      <td>2.0</td>
      <td>3</td>
      <td>1</td>
      <td>349909</td>
      <td>21.0750</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>8</td>
      <td>9</td>
      <td>1</td>
      <td>3</td>
      <td>Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)</td>
      <td>female</td>
      <td>27.0</td>
      <td>0</td>
      <td>2</td>
      <td>347742</td>
      <td>11.1333</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>9</td>
      <td>10</td>
      <td>1</td>
      <td>2</td>
      <td>Nasser, Mrs. Nicholas (Adele Achem)</td>
      <td>female</td>
      <td>14.0</td>
      <td>1</td>
      <td>0</td>
      <td>237736</td>
      <td>30.0708</td>
      <td>NaN</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>892</td>
      <td>3</td>
      <td>Kelly, Mr. James</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <td>1</td>
      <td>893</td>
      <td>3</td>
      <td>Wilkes, Mrs. James (Ellen Needs)</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>2</td>
      <td>894</td>
      <td>2</td>
      <td>Myles, Mr. Thomas Francis</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
    </tr>
    <tr>
      <td>3</td>
      <td>895</td>
      <td>3</td>
      <td>Wirz, Mr. Albert</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>4</td>
      <td>896</td>
      <td>3</td>
      <td>Hirvonen, Mrs. Alexander (Helga E Lindqvist)</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.shape
```




    (891, 12)




```python
test.shape
```




    (418, 11)




```python
train.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 12 columns):
    PassengerId    891 non-null int64
    Survived       891 non-null int64
    Pclass         891 non-null int64
    Name           891 non-null object
    Sex            891 non-null object
    Age            714 non-null float64
    SibSp          891 non-null int64
    Parch          891 non-null int64
    Ticket         891 non-null object
    Fare           891 non-null float64
    Cabin          204 non-null object
    Embarked       889 non-null object
    dtypes: float64(2), int64(5), object(5)
    memory usage: 83.7+ KB



```python
test.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 418 entries, 0 to 417
    Data columns (total 11 columns):
    PassengerId    418 non-null int64
    Pclass         418 non-null int64
    Name           418 non-null object
    Sex            418 non-null object
    Age            332 non-null float64
    SibSp          418 non-null int64
    Parch          418 non-null int64
    Ticket         418 non-null object
    Fare           417 non-null float64
    Cabin          91 non-null object
    Embarked       418 non-null object
    dtypes: float64(2), int64(4), object(5)
    memory usage: 36.0+ KB



```python
train.isna().sum() # = train.isnull().sum()
```




    PassengerId      0
    Survived         0
    Pclass           0
    Name             0
    Sex              0
    Age            177
    SibSp            0
    Parch            0
    Ticket           0
    Fare             0
    Cabin          687
    Embarked         2
    dtype: int64




```python
test.isna().sum()
```




    PassengerId      0
    Pclass           0
    Name             0
    Sex              0
    Age             86
    SibSp            0
    Parch            0
    Ticket           0
    Fare             1
    Cabin          327
    Embarked         0
    dtype: int64




```python
#Let us explore the data: (pay attention to the age column)
train.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>714.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
      <td>891.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>446.000000</td>
      <td>0.383838</td>
      <td>2.308642</td>
      <td>29.699118</td>
      <td>0.523008</td>
      <td>0.381594</td>
      <td>32.204208</td>
    </tr>
    <tr>
      <td>std</td>
      <td>257.353842</td>
      <td>0.486592</td>
      <td>0.836071</td>
      <td>14.526497</td>
      <td>1.102743</td>
      <td>0.806057</td>
      <td>49.693429</td>
    </tr>
    <tr>
      <td>min</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.420000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>223.500000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>20.125000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.910400</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>446.000000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>28.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>668.500000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>38.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.000000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>891.000000</td>
      <td>1.000000</td>
      <td>3.000000</td>
      <td>80.000000</td>
      <td>8.000000</td>
      <td>6.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.describe()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>count</td>
      <td>418.000000</td>
      <td>418.000000</td>
      <td>332.000000</td>
      <td>418.000000</td>
      <td>418.000000</td>
      <td>417.000000</td>
    </tr>
    <tr>
      <td>mean</td>
      <td>1100.500000</td>
      <td>2.265550</td>
      <td>30.272590</td>
      <td>0.447368</td>
      <td>0.392344</td>
      <td>35.627188</td>
    </tr>
    <tr>
      <td>std</td>
      <td>120.810458</td>
      <td>0.841838</td>
      <td>14.181209</td>
      <td>0.896760</td>
      <td>0.981429</td>
      <td>55.907576</td>
    </tr>
    <tr>
      <td>min</td>
      <td>892.000000</td>
      <td>1.000000</td>
      <td>0.170000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <td>25%</td>
      <td>996.250000</td>
      <td>1.000000</td>
      <td>21.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.895800</td>
    </tr>
    <tr>
      <td>50%</td>
      <td>1100.500000</td>
      <td>3.000000</td>
      <td>27.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.454200</td>
    </tr>
    <tr>
      <td>75%</td>
      <td>1204.750000</td>
      <td>3.000000</td>
      <td>39.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>31.500000</td>
    </tr>
    <tr>
      <td>max</td>
      <td>1309.000000</td>
      <td>3.000000</td>
      <td>76.000000</td>
      <td>8.000000</td>
      <td>9.000000</td>
      <td>512.329200</td>
    </tr>
  </tbody>
</table>
</div>



## Bar Chart for Categorical Features
- Pclass
- Sex
- SibSp ( # of siblings and spouse)
- Parch ( # of parents and children)
- Embarked
- Cabin


```python
# Count of people who survive:
train['Survived'].value_counts()
```




    0    549
    1    342
    Name: Survived, dtype: int64




```python
def bar_chart(feature):
    Survived= train[train['Survived']==1][feature].value_counts()
    Dead= train[train['Survived']==0][feature].value_counts()
    df = pd.DataFrame([Survived,Dead])
    df.index= ['Survived','Dead']
    df.plot(kind='bar', stacked =True, figsize =(10,5))
```


```python
bar_chart('Sex')
```


![png](output_26_0.png)


Women are more likely to survive than Men


```python
bar_chart('Pclass')
```


![png](output_28_0.png)


The Chart confirms 1st class more likely survivied than other classes
The Chart confirms 3rd class more likely dead than other classes


```python
bar_chart('SibSp')
```


![png](output_30_0.png)


The Chart confirms a person aboarded with more than 2 siblings or spouse more likely survived
The Chart confirms a person aboarded without siblings or spouse more likely dead


```python
bar_chart('Parch')
```


![png](output_32_0.png)


The Chart confirms a person aboarded with more than 2 parents or children more likely survived
The Chart confirms a person aboarded alone more likely dead


```python
bar_chart('Embarked')
```


![png](output_34_0.png)


- The Chart confirms a person aboarded from C slightly more likely survived
- The Chart confirms a person aboarded from Q more likely dead
- The Chart confirms a person aboarded from S more likely dead

# 4. Feature engineering

- The purpose of Feautre engineering is to prepare the data for machine learning algorithms by creating feature vectors.
- Feature vector is an n dimensional vector that represent some object


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
    </tr>
  </tbody>
</table>
</div>



## 4.1 how titanic sank?

- sank from the bow of the ship where third class rooms located
- conclusion, Pclass is key feature for classifier


```python
Image(url= "https://static1.squarespace.com/static/5006453fe4b09ef2252ba068/t/5090b249e4b047ba54dfd258/1351660113175/TItanic-Survival-Infographic.jpg?format=1500w")
```




<img src="https://static1.squarespace.com/static/5006453fe4b09ef2252ba068/t/5090b249e4b047ba54dfd258/1351660113175/TItanic-Survival-Infographic.jpg?format=1500w"/>



## 4.2 Name


```python
train_test_data=[train,test] # combining train and test dataset

train['Title']=0
for i in train_test_data:
    train['Title']=train.Name.str.extract('([A-Za-z]+)\.') #extracting Name initials
    test['Title']=test.Name.str.extract('([A-Za-z]+)\.')
```


```python
train['Title'].value_counts()
```




    Mr          517
    Miss        182
    Mrs         125
    Master       40
    Dr            7
    Rev           6
    Mlle          2
    Major         2
    Col           2
    Jonkheer      1
    Don           1
    Lady          1
    Sir           1
    Mme           1
    Ms            1
    Capt          1
    Countess      1
    Name: Title, dtype: int64




```python
train['Title'].value_counts().sum()
```




    891




```python
test['Title'].value_counts()
```




    Mr        240
    Miss       78
    Mrs        72
    Master     21
    Rev         2
    Col         2
    Dr          1
    Dona        1
    Ms          1
    Name: Title, dtype: int64




```python
test['Title'].value_counts().sum()
```




    418




```python
pd.crosstab(train.Title,train.Sex).T.style.background_gradient(cmap='summer_r')

```




<style  type="text/css" >
    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col3 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col4 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col5 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col6 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col7 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col8 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col9 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col10 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col11 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col12 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col13 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col14 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col15 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col16 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col3 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col4 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col5 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col6 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col7 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col8 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col9 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col10 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col11 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col12 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col13 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col14 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col15 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col16 {
            background-color:  #008066;
            color:  #f1f1f1;
        }</style><table id="T_9229510a_627b_11ea_a22c_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Title</th>        <th class="col_heading level0 col0" >Capt</th>        <th class="col_heading level0 col1" >Col</th>        <th class="col_heading level0 col2" >Countess</th>        <th class="col_heading level0 col3" >Don</th>        <th class="col_heading level0 col4" >Dr</th>        <th class="col_heading level0 col5" >Jonkheer</th>        <th class="col_heading level0 col6" >Lady</th>        <th class="col_heading level0 col7" >Major</th>        <th class="col_heading level0 col8" >Master</th>        <th class="col_heading level0 col9" >Miss</th>        <th class="col_heading level0 col10" >Mlle</th>        <th class="col_heading level0 col11" >Mme</th>        <th class="col_heading level0 col12" >Mr</th>        <th class="col_heading level0 col13" >Mrs</th>        <th class="col_heading level0 col14" >Ms</th>        <th class="col_heading level0 col15" >Rev</th>        <th class="col_heading level0 col16" >Sir</th>    </tr>    <tr>        <th class="index_name level0" >Sex</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_9229510a_627b_11ea_a22c_c0b6f9c05084level0_row0" class="row_heading level0 row0" >female</th>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col0" class="data row0 col0" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col1" class="data row0 col1" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col2" class="data row0 col2" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col3" class="data row0 col3" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col4" class="data row0 col4" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col5" class="data row0 col5" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col6" class="data row0 col6" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col7" class="data row0 col7" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col8" class="data row0 col8" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col9" class="data row0 col9" >182</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col10" class="data row0 col10" >2</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col11" class="data row0 col11" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col12" class="data row0 col12" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col13" class="data row0 col13" >125</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col14" class="data row0 col14" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col15" class="data row0 col15" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row0_col16" class="data row0 col16" >0</td>
            </tr>
            <tr>
                        <th id="T_9229510a_627b_11ea_a22c_c0b6f9c05084level0_row1" class="row_heading level0 row1" >male</th>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col0" class="data row1 col0" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col1" class="data row1 col1" >2</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col2" class="data row1 col2" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col3" class="data row1 col3" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col4" class="data row1 col4" >6</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col5" class="data row1 col5" >1</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col6" class="data row1 col6" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col7" class="data row1 col7" >2</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col8" class="data row1 col8" >40</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col9" class="data row1 col9" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col10" class="data row1 col10" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col11" class="data row1 col11" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col12" class="data row1 col12" >517</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col13" class="data row1 col13" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col14" class="data row1 col14" >0</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col15" class="data row1 col15" >6</td>
                        <td id="T_9229510a_627b_11ea_a22c_c0b6f9c05084row1_col16" class="data row1 col16" >1</td>
            </tr>
    </tbody></table>




```python
pd.crosstab(test.Title,test.Sex).T.style.background_gradient(cmap='summer_r')

```




<style  type="text/css" >
    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col3 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col4 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col5 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col6 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col7 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col8 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col3 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col4 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col5 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col6 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col7 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col8 {
            background-color:  #008066;
            color:  #f1f1f1;
        }</style><table id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Title</th>        <th class="col_heading level0 col0" >Col</th>        <th class="col_heading level0 col1" >Dona</th>        <th class="col_heading level0 col2" >Dr</th>        <th class="col_heading level0 col3" >Master</th>        <th class="col_heading level0 col4" >Miss</th>        <th class="col_heading level0 col5" >Mr</th>        <th class="col_heading level0 col6" >Mrs</th>        <th class="col_heading level0 col7" >Ms</th>        <th class="col_heading level0 col8" >Rev</th>    </tr>    <tr>        <th class="index_name level0" >Sex</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084level0_row0" class="row_heading level0 row0" >female</th>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col0" class="data row0 col0" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col1" class="data row0 col1" >1</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col2" class="data row0 col2" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col3" class="data row0 col3" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col4" class="data row0 col4" >78</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col5" class="data row0 col5" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col6" class="data row0 col6" >72</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col7" class="data row0 col7" >1</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row0_col8" class="data row0 col8" >0</td>
            </tr>
            <tr>
                        <th id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084level0_row1" class="row_heading level0 row1" >male</th>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col0" class="data row1 col0" >2</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col1" class="data row1 col1" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col2" class="data row1 col2" >1</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col3" class="data row1 col3" >21</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col4" class="data row1 col4" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col5" class="data row1 col5" >240</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col6" class="data row1 col6" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col7" class="data row1 col7" >0</td>
                        <td id="T_93ed593a_627b_11ea_a5fe_c0b6f9c05084row1_col8" class="data row1 col8" >2</td>
            </tr>
    </tbody></table>




```python
train['Title'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','Countess',
                               'Jonkheer','Col','Rev','Capt','Sir','Don'],['Miss',
                                'Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)

test['Title'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','Countess',
                               'Jonkheer','Col','Rev','Capt','Sir','Don'],['Miss',
                                'Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Name</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>Miss</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>Allen, Mr. William Henry</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mr</td>
    </tr>
  </tbody>
</table>
</div>




```python
train['Title'].value_counts()
```




    Mr        529
    Miss      186
    Mrs       127
    Master     40
    Other       9
    Name: Title, dtype: int64




```python
train['Title'].value_counts().sum()
```




    891




```python
test['Title'].value_counts()
```




    Mr        241
    Miss       79
    Mrs        72
    Master     21
    Other       4
    Dona        1
    Name: Title, dtype: int64




```python
test['Title'].value_counts().sum()
```




    418




```python
# delete unnecessary feature from dataset
train.drop('Name', axis=1, inplace=True)
test.drop('Name', axis=1, inplace=True)
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>Miss</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mr</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>892</td>
      <td>3</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>1</td>
      <td>893</td>
      <td>3</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>2</td>
      <td>894</td>
      <td>2</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>3</td>
      <td>895</td>
      <td>3</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>4</td>
      <td>896</td>
      <td>3</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
      <td>Mrs</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(train.Title,train.Sex).T.style.background_gradient(cmap='summer_r')

```




<style  type="text/css" >
    #T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col3 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col4 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col3 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col4 {
            background-color:  #008066;
            color:  #f1f1f1;
        }</style><table id="T_c285421c_627b_11ea_a401_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Title</th>        <th class="col_heading level0 col0" >Master</th>        <th class="col_heading level0 col1" >Miss</th>        <th class="col_heading level0 col2" >Mr</th>        <th class="col_heading level0 col3" >Mrs</th>        <th class="col_heading level0 col4" >Other</th>    </tr>    <tr>        <th class="index_name level0" >Sex</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_c285421c_627b_11ea_a401_c0b6f9c05084level0_row0" class="row_heading level0 row0" >female</th>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col0" class="data row0 col0" >0</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col1" class="data row0 col1" >186</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col2" class="data row0 col2" >1</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col3" class="data row0 col3" >127</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row0_col4" class="data row0 col4" >0</td>
            </tr>
            <tr>
                        <th id="T_c285421c_627b_11ea_a401_c0b6f9c05084level0_row1" class="row_heading level0 row1" >male</th>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col0" class="data row1 col0" >40</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col1" class="data row1 col1" >0</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col2" class="data row1 col2" >528</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col3" class="data row1 col3" >0</td>
                        <td id="T_c285421c_627b_11ea_a401_c0b6f9c05084row1_col4" class="data row1 col4" >9</td>
            </tr>
    </tbody></table>




```python
bar_chart('Title')
```


![png](output_60_0.png)


## 4.3 Age


```python
print('Oldest person Survived was of:',train['Age'].max())
print('Youngest person Survived was of:',train['Age'].min())
print('Average person Survived was of:',train['Age'].mean())
```

    Oldest person Survived was of: 80.0
    Youngest person Survived was of: 0.42
    Average person Survived was of: 29.69911764705882



```python
f,ax=plt.subplots(1,2,figsize=(18,8))
sns.violinplot('Pclass','Age',hue='Survived',data=train,split=True,ax=ax[0])
ax[0].set_title('PClass and Age vs Survived')
ax[0].set_yticks(range(0,110,10))
sns.violinplot("Sex","Age", hue="Survived", data=train,split=True,ax=ax[1])
ax[1].set_title('Sex and Age vs Survived')
ax[1].set_yticks(range(0,110,10))
plt.show()
```


![png](output_63_0.png)



```python
train.groupby('Title')['Age'].mean()

```




    Title
    Master     4.574167
    Miss      21.860000
    Mr        32.739609
    Mrs       35.981818
    Other     45.888889
    Name: Age, dtype: float64




```python
train.loc[(train.Age.isnull()) & (train.Title=='Mr'),'Age']=33
train.loc[(train.Age.isnull()) & (train.Title=='Mrs'),'Age']=36
train.loc[(train.Age.isnull()) & (train.Title=='Master'),'Age']=5
train.loc[(train.Age.isnull()) & (train.Title=='Miss'),'Age']=22
train.loc[(train.Age.isnull()) & (train.Title=='Other'),'Age']=46
```


```python
train.Age.isnull().any()

```




    False



### Title map
- Mr : 0
- Miss : 1
- Mrs: 2
- Master: 3
- Other: 4


```python
title_mapping = {"Mr": 0, "Miss": 1, "Mrs": 2,
                 "Master": 3, "Other":4 }
for dataset in train_test_data:
    dataset['Title'] = dataset['Title'].map(title_mapping)
```


```python
bar_chart('Title')
```


![png](output_69_0.png)



```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>892</td>
      <td>3</td>
      <td>male</td>
      <td>34.5</td>
      <td>0</td>
      <td>0</td>
      <td>330911</td>
      <td>7.8292</td>
      <td>NaN</td>
      <td>Q</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>893</td>
      <td>3</td>
      <td>female</td>
      <td>47.0</td>
      <td>1</td>
      <td>0</td>
      <td>363272</td>
      <td>7.0000</td>
      <td>NaN</td>
      <td>S</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>894</td>
      <td>2</td>
      <td>male</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>240276</td>
      <td>9.6875</td>
      <td>NaN</td>
      <td>Q</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>895</td>
      <td>3</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>315154</td>
      <td>8.6625</td>
      <td>NaN</td>
      <td>S</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>896</td>
      <td>3</td>
      <td>female</td>
      <td>22.0</td>
      <td>1</td>
      <td>1</td>
      <td>3101298</td>
      <td>12.2875</td>
      <td>NaN</td>
      <td>S</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
f,ax=plt.subplots(1,2,figsize=(20,20))
train[train['Survived']==0].Age.plot.hist(ax=ax[0],bins=20,edgecolor='black',color='red')
ax[0].set_title('Survived = 0')
x1=list(range(0,85,5))
ax[0].set_xticks(x1)
train[train['Survived']==1].Age.plot.hist(ax=ax[1],bins=20,edgecolor='black',color='green')
x2=list(range(0,85,5))
ax[1].set_xticks(x2)
ax[1].set_title('Survived = 1')
plt.show()
```


![png](output_72_0.png)



```python
facet =sns.FacetGrid(train, hue='Survived',aspect=4)
facet.map(sns.kdeplot,'Age',shade=True)
facet.set(xlim=(0, train['Age'].max()))
facet.add_legend()
plt.show()
```


![png](output_73_0.png)



```python
grid = sns.FacetGrid(train, col='Survived', row='Pclass', size=2.2, aspect=1.6)
grid.map(plt.hist, 'Age', alpha=.5, bins=20)
grid.add_legend();
```


![png](output_74_0.png)



```python
for dataset in train_test_data:
    dataset.loc[dataset['Age']<= 16, 'Age']= 0,
    dataset.loc[(dataset['Age']> 16) & (dataset['Age']<=26), 'Age']= 1,
    dataset.loc[(dataset['Age']> 26) & (dataset['Age']<=36), 'Age']= 2,
    dataset.loc[(dataset['Age']> 36) & (dataset['Age']<=62), 'Age']= 3,
    dataset.loc[dataset['Age']> 62, 'Age']= 4
```


```python
bar_chart("Age")
```


![png](output_76_0.png)



```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



## 4.4 Sex



```python
train.groupby(['Sex', 'Survived'])['Survived'].count()

```




    Sex     Survived
    female  0            81
            1           233
    male    0           468
            1           109
    Name: Survived, dtype: int64




```python
train.groupby('Sex')[['Survived']].mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Survived</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>female</td>
      <td>0.742038</td>
    </tr>
    <tr>
      <td>male</td>
      <td>0.188908</td>
    </tr>
  </tbody>
</table>
</div>




```python
train[['Sex','Survived']].groupby(['Sex']).mean().plot.bar()
sns.countplot('Sex',hue='Survived',data=train,)
plt.show()
```


![png](output_81_0.png)



```python
sex_mapping = {"male": 0, "female": 1}
for dataset in train_test_data:
    dataset['Sex'] = dataset['Sex'].map(sex_mapping)
```


```python
bar_chart('Sex')
```


![png](output_83_0.png)



```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.info()

```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 12 columns):
    PassengerId    891 non-null int64
    Survived       891 non-null int64
    Pclass         891 non-null int64
    Sex            891 non-null int64
    Age            891 non-null float64
    SibSp          891 non-null int64
    Parch          891 non-null int64
    Ticket         891 non-null object
    Fare           891 non-null float64
    Cabin          204 non-null object
    Embarked       889 non-null object
    Title          891 non-null int64
    dtypes: float64(2), int64(7), object(3)
    memory usage: 83.7+ KB



```python
test.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 418 entries, 0 to 417
    Data columns (total 11 columns):
    PassengerId    418 non-null int64
    Pclass         418 non-null int64
    Sex            418 non-null int64
    Age            332 non-null float64
    SibSp          418 non-null int64
    Parch          418 non-null int64
    Ticket         418 non-null object
    Fare           417 non-null float64
    Cabin          91 non-null object
    Embarked       418 non-null object
    Title          417 non-null float64
    dtypes: float64(3), int64(5), object(3)
    memory usage: 36.0+ KB


## 4.5 Pclass


```python
sns.countplot('Pclass', hue='Survived', data=train)
plt.title('Pclass: Sruvived vs Dead')
plt.show()
```


![png](output_88_0.png)



```python
pd.crosstab([train.Sex,train.Survived],train.Pclass,margins=True).style.background_gradient(cmap='summer_r')
```




<style  type="text/css" >
    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col0 {
            background-color:  #a7d366;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col1 {
            background-color:  #85c266;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col2 {
            background-color:  #6eb666;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col3 {
            background-color:  #85c266;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col0 {
            background-color:  #cde666;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col1 {
            background-color:  #f0f866;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col3 {
            background-color:  #f7fb66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col2 {
            background-color:  #f1f866;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col3 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col0 {
            background-color:  #96cb66;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col1 {
            background-color:  #a3d166;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col2 {
            background-color:  #f1f866;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col3 {
            background-color:  #cfe766;
            color:  #000000;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col3 {
            background-color:  #008066;
            color:  #f1f1f1;
        }</style><table id="T_6d363464_627d_11ea_bf41_c0b6f9c05084" ><thead>    <tr>        <th class="blank" ></th>        <th class="index_name level0" >Pclass</th>        <th class="col_heading level0 col0" >1</th>        <th class="col_heading level0 col1" >2</th>        <th class="col_heading level0 col2" >3</th>        <th class="col_heading level0 col3" >All</th>    </tr>    <tr>        <th class="index_name level0" >Sex</th>        <th class="index_name level1" >Survived</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level0_row0" class="row_heading level0 row0" rowspan=2>0</th>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level1_row0" class="row_heading level1 row0" >0</th>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col0" class="data row0 col0" >77</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col1" class="data row0 col1" >91</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col2" class="data row0 col2" >300</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row0_col3" class="data row0 col3" >468</td>
            </tr>
            <tr>
                                <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level1_row1" class="row_heading level1 row1" >1</th>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col0" class="data row1 col0" >45</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col1" class="data row1 col1" >17</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col2" class="data row1 col2" >47</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row1_col3" class="data row1 col3" >109</td>
            </tr>
            <tr>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level0_row2" class="row_heading level0 row2" rowspan=2>1</th>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level1_row2" class="row_heading level1 row2" >0</th>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col0" class="data row2 col0" >3</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col1" class="data row2 col1" >6</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col2" class="data row2 col2" >72</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row2_col3" class="data row2 col3" >81</td>
            </tr>
            <tr>
                                <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level1_row3" class="row_heading level1 row3" >1</th>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col0" class="data row3 col0" >91</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col1" class="data row3 col1" >70</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col2" class="data row3 col2" >72</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row3_col3" class="data row3 col3" >233</td>
            </tr>
            <tr>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level0_row4" class="row_heading level0 row4" >All</th>
                        <th id="T_6d363464_627d_11ea_bf41_c0b6f9c05084level1_row4" class="row_heading level1 row4" ></th>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col0" class="data row4 col0" >216</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col1" class="data row4 col1" >184</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col2" class="data row4 col2" >491</td>
                        <td id="T_6d363464_627d_11ea_bf41_c0b6f9c05084row4_col3" class="data row4 col3" >891</td>
            </tr>
    </tbody></table>




```python
sns.factorplot('Pclass', 'Survived', hue='Sex', data=train)
plt.show()
```


![png](output_90_0.png)



```python
sns.factorplot('Pclass','Survived',col='Title',data=train)
plt.show()
```


![png](output_91_0.png)


## 4.6 SibSip



```python
pd.crosstab([train.SibSp],train.Survived).style.background_gradient('summer_r')

```




<style  type="text/css" >
    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row0_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row0_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row1_col0 {
            background-color:  #c4e266;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row1_col1 {
            background-color:  #77bb66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row2_col0 {
            background-color:  #f9fc66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row2_col1 {
            background-color:  #f0f866;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row3_col0 {
            background-color:  #fbfd66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row3_col1 {
            background-color:  #fbfd66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row4_col0 {
            background-color:  #f9fc66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row4_col1 {
            background-color:  #fcfe66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row5_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row5_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row6_col0 {
            background-color:  #fefe66;
            color:  #000000;
        }    #T_795216b0_627d_11ea_81c5_c0b6f9c05084row6_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }</style><table id="T_795216b0_627d_11ea_81c5_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Survived</th>        <th class="col_heading level0 col0" >0</th>        <th class="col_heading level0 col1" >1</th>    </tr>    <tr>        <th class="index_name level0" >SibSp</th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row0_col0" class="data row0 col0" >398</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row0_col1" class="data row0 col1" >210</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row1_col0" class="data row1 col0" >97</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row1_col1" class="data row1 col1" >112</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row2_col0" class="data row2 col0" >15</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row2_col1" class="data row2 col1" >13</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row3_col0" class="data row3 col0" >12</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row3_col1" class="data row3 col1" >4</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row4_col0" class="data row4 col0" >15</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row4_col1" class="data row4 col1" >3</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row5_col0" class="data row5 col0" >5</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row5_col1" class="data row5 col1" >0</td>
            </tr>
            <tr>
                        <th id="T_795216b0_627d_11ea_81c5_c0b6f9c05084level0_row6" class="row_heading level0 row6" >8</th>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row6_col0" class="data row6 col0" >7</td>
                        <td id="T_795216b0_627d_11ea_81c5_c0b6f9c05084row6_col1" class="data row6 col1" >0</td>
            </tr>
    </tbody></table>




```python
f,ax=plt.subplots(1,2,figsize=(20,8))
sns.barplot('SibSp','Survived', data=train,ax=ax[0])
ax[0].set_title('SipSp vs Survived in BarPlot')
sns.factorplot('SibSp','Survived', data=train,ax=ax[1])
ax[1].set_title('SibSp vs Survived in FactorPlot')
plt.close(2)
plt.show()
```


![png](output_94_0.png)



```python
pd.crosstab(train.SibSp,train.Pclass).style.background_gradient('summer_r')

```




<style  type="text/css" >
    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col0 {
            background-color:  #7bbd66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col1 {
            background-color:  #8ac466;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col2 {
            background-color:  #c6e266;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col0 {
            background-color:  #f6fa66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col1 {
            background-color:  #eef666;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col2 {
            background-color:  #f8fc66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col0 {
            background-color:  #fafc66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col1 {
            background-color:  #fdfe66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col2 {
            background-color:  #fafc66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col2 {
            background-color:  #f6fa66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col2 {
            background-color:  #fefe66;
            color:  #000000;
        }</style><table id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Pclass</th>        <th class="col_heading level0 col0" >1</th>        <th class="col_heading level0 col1" >2</th>        <th class="col_heading level0 col2" >3</th>    </tr>    <tr>        <th class="index_name level0" >SibSp</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col0" class="data row0 col0" >137</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col1" class="data row0 col1" >120</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row0_col2" class="data row0 col2" >351</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col0" class="data row1 col0" >71</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col1" class="data row1 col1" >55</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row1_col2" class="data row1 col2" >83</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col0" class="data row2 col0" >5</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col1" class="data row2 col1" >8</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row2_col2" class="data row2 col2" >15</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col0" class="data row3 col0" >3</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col1" class="data row3 col1" >1</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row3_col2" class="data row3 col2" >12</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col0" class="data row4 col0" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col1" class="data row4 col1" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row4_col2" class="data row4 col2" >18</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col0" class="data row5 col0" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col1" class="data row5 col1" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row5_col2" class="data row5 col2" >5</td>
            </tr>
            <tr>
                        <th id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084level0_row6" class="row_heading level0 row6" >8</th>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col0" class="data row6 col0" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col1" class="data row6 col1" >0</td>
                        <td id="T_810a8652_627d_11ea_8cc2_c0b6f9c05084row6_col2" class="data row6 col2" >7</td>
            </tr>
    </tbody></table>




```python
f,ax=plt.subplots(1,2,figsize=(20,8))
sns.barplot('Pclass','Survived', data=train,ax=ax[0])
ax[0].set_title('Pclass vs Survived in BarPlot')
sns.factorplot('Pclass','Survived', data=train,ax=ax[1])
ax[1].set_title('Pclass vs Survived in FactorPlot')
plt.close(2)
plt.show()
```


![png](output_96_0.png)



```python
sns.countplot(train['Survived'],label="Count")
```




    <matplotlib.axes._subplots.AxesSubplot at 0x1be652cdc48>




![png](output_97_1.png)


## 4.7 Embarked


```python
FacetGrid = sns.FacetGrid(train, row='Embarked', size=4.5, aspect=1.6)
FacetGrid.map(sns.pointplot, 'Pclass', 'Survived', 'Sex', palette=None,  order=None, hue_order=None )
FacetGrid.add_legend()
```




    <seaborn.axisgrid.FacetGrid at 0x1be65530cc8>




![png](output_99_1.png)



```python
Pclass1 = train[train['Pclass']==1]['Embarked'].value_counts()
Pclass2 = train[train['Pclass']==2]['Embarked'].value_counts()
Pclass3 = train[train['Pclass']==3]['Embarked'].value_counts()
df = pd.DataFrame([Pclass1, Pclass2, Pclass3])
df.index = ['1st class','2nd class', '3rd class']
df.plot(kind='bar',stacked=True, figsize=(10,5))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x1be654a8388>




![png](output_100_1.png)


fill out missing embark with S embark



```python
for dataset in train_test_data:
    dataset['Embarked'] = dataset['Embarked'].fillna('S')
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>7.2500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>71.2833</td>
      <td>C85</td>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>7.9250</td>
      <td>NaN</td>
      <td>S</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>53.1000</td>
      <td>C123</td>
      <td>S</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>8.0500</td>
      <td>NaN</td>
      <td>S</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
embarked_mapping = {"S": 0, "C": 1, "Q": 2}
for dataset in train_test_data:
    dataset['Embarked'] = dataset['Embarked'].map(embarked_mapping)
```


```python
train.Embarked.isnull().any()
```




    False




```python
#Look at survival rate by sex, age and class
age = pd.cut(train['Age'], [0, 18, 80])
train.pivot_table('Survived', ['Sex', age], 'Pclass')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
    <tr>
      <th>Sex</th>
      <th>Age</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>(0, 18]</td>
      <td>0.352941</td>
      <td>0.082474</td>
      <td>0.114379</td>
    </tr>
    <tr>
      <td>1</td>
      <td>(0, 18]</td>
      <td>0.977273</td>
      <td>0.909091</td>
      <td>0.486486</td>
    </tr>
  </tbody>
</table>
</div>



## 4.8 Fare price



```python
# fill for missing value with the median fare for each class:
train['Fare'].fillna(train.groupby('Pclass')['Fare'].transform('median'), inplace= True)
test['Fare'].fillna(test.groupby('Pclass')['Fare'].transform('median'), inplace= True)
```


```python
#Plot the Prices Paid Of Each Class
plt.scatter(train['Fare'], train['Pclass'],  color = 'purple', label='Passenger Paid')
plt.ylabel('Class')
plt.xlabel('Price / Fare')
plt.title('Price Of Each Class')
plt.legend()
plt.show()
```


![png](output_109_0.png)



```python
facet =sns.FacetGrid(train, hue='Survived',aspect=4)
facet.map(sns.kdeplot,'Fare',shade=True)
facet.set(xlim=(0, train['Fare'].max()))
facet.add_legend()
plt.show()
```


![png](output_110_0.png)



```python
facet =sns.FacetGrid(train, hue='Survived',aspect=4)
facet.map(sns.kdeplot,'Fare',shade=True)
facet.set(xlim=(0, train['Fare'].max()))
facet.add_legend()
plt.xlim(0,200)
```




    (0, 200)




![png](output_111_1.png)



```python
 for dataset in train_test_data:
    dataset.loc[ dataset['Fare'] <= 17, 'Fare'] = 0,
    dataset.loc[(dataset['Fare'] > 17) & (dataset['Fare'] <= 30), 'Fare'] = 1,
    dataset.loc[(dataset['Fare'] > 30) & (dataset['Fare'] <= 100), 'Fare'] = 2,
    dataset.loc[ dataset['Fare'] > 100, 'Fare'] = 3
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>2.0</td>
      <td>C85</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>2.0</td>
      <td>C123</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.Fare.isnull().any()
```




    False



## 4.9 Cabins


```python
train.Cabin.value_counts()
```




    B96 B98        4
    C23 C25 C27    4
    G6             4
    E101           3
    C22 C26        3
                  ..
    A26            1
    B86            1
    B4             1
    A10            1
    C110           1
    Name: Cabin, Length: 147, dtype: int64




```python
for dataset in train_test_data:
    dataset['Cabin']=dataset['Cabin'].str[:1]
```


```python
Pclass1 = train[train['Pclass']==1]['Cabin'].value_counts()
Pclass2 = train[train['Pclass']==2]['Cabin'].value_counts()
Pclass3 = train[train['Pclass']==3]['Cabin'].value_counts()
df=pd.DataFrame([Pclass1, Pclass2, Pclass3])
df.index= ['1st class','2nd class','3rd class']
df.plot(kind = 'bar', stacked = True, figsize =(10,5))
```




    <matplotlib.axes._subplots.AxesSubplot at 0x1be673cf4c8>




![png](output_118_1.png)



```python
cabin_mapping = {"A": 0, "B": 0.4, "C": 0.8, "D": 1.2, "E": 1.6, "F": 2, "G": 2.4, "T": 2.8}
for dataset in train_test_data:
    dataset['Cabin'] = dataset['Cabin'].map(cabin_mapping)
```


```python
# fill missing Fare with median fare for each Pclass
train["Cabin"].fillna(train.groupby("Pclass")["Cabin"].transform("median"), inplace=True)
test["Cabin"].fillna(test.groupby("Pclass")["Cabin"].transform("median"), inplace=True)
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
train.Embarked.isnull().any()
```




    False



## 4.10 FamilySize



```python
train["FamilySize"] = train["SibSp"] + train["Parch"] + 1
test["FamilySize"] = test["SibSp"] + test["Parch"] + 1
```


```python
facet = sns.FacetGrid(train, hue="Survived",aspect=4)
facet.map(sns.kdeplot,'FamilySize',shade= True)
facet.set(xlim=(0, train['FamilySize'].max()))
facet.add_legend()
plt.xlim(0)
```




    (0, 11.0)




![png](output_125_1.png)



```python
family_mapping = {1: 0, 2: 0.4, 3: 0.8, 4: 1.2, 5: 1.6, 6: 2, 7: 2.4, 8: 2.8, 9: 3.2, 10: 3.6, 11: 4}
for dataset in train_test_data:
    dataset['FamilySize'] = dataset['FamilySize'].map(family_mapping)
```


```python
train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PassengerId</th>
      <th>Survived</th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>SibSp</th>
      <th>Parch</th>
      <th>Ticket</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
      <th>FamilySize</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>1</td>
      <td>0</td>
      <td>A/5 21171</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>1</td>
      <td>0</td>
      <td>PC 17599</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>1</td>
      <td>2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>STON/O2. 3101282</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>4</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>1</td>
      <td>0</td>
      <td>113803</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>0</td>
      <td>2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>4</td>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>373450</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Print the unique values in the columns
print(train['Sex'].unique())
print(train['Embarked'].unique())
```

    ['male' 'female']
    ['S' 'C' 'Q' nan]


# 5. Modeling

### 5.1 Supervised Learning


```python
# Importing Classifier Modules
from sklearn.neighbors import KNeighborsClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.naive_bayes import GaussianNB
from sklearn.svm import SVC

import numpy as np
```


```python
train.info()

```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 13 columns):
    PassengerId    891 non-null int64
    Survived       891 non-null int64
    Pclass         891 non-null int64
    Sex            891 non-null int64
    Age            891 non-null float64
    SibSp          891 non-null int64
    Parch          891 non-null int64
    Ticket         891 non-null object
    Fare           891 non-null float64
    Cabin          891 non-null float64
    Embarked       891 non-null int64
    Title          891 non-null int64
    FamilySize     891 non-null float64
    dtypes: float64(4), int64(8), object(1)
    memory usage: 90.6+ KB



```python
features_drop = ['Ticket', 'SibSp', 'Parch']
train = train.drop(features_drop, axis=1)
test = test.drop(features_drop, axis=1)
train = train.drop(['PassengerId'], axis=1)
```


```python
train_data = train.drop('Survived', axis=1)
target = train['Survived']

train_data.shape, target.shape
```




    ((891, 8), (891,))




```python
train_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pclass</th>
      <th>Sex</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Cabin</th>
      <th>Embarked</th>
      <th>Title</th>
      <th>FamilySize</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>1</td>
      <td>2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.8</td>
      <td>0</td>
      <td>2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0</td>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
target.head()
```




    0    0
    1    1
    2    1
    3    1
    4    0
    Name: Survived, dtype: int64




```python
colormap = plt.cm.viridis
plt.figure(figsize=(12,12))
plt.title('Pearson Correlation of Features', y=1.05, size=15)
sns.heatmap(train.astype(float).corr(),linewidths=0.1,vmax=1.0, square=True, cmap=colormap, linecolor='white', annot=True)

```




    <matplotlib.axes._subplots.AxesSubplot at 0x1be6750f088>




![png](output_137_1.png)



```python
# Split the dataset into 80% Training set and 20% Testing set
from sklearn.model_selection import train_test_split
X_train, X_test, Y_train, Y_test = train_test_split(train_data, target, test_size = 0.2, random_state = 0)
```


```python
# Scale the data to bring all features to the same level of magnitude
# This means the data will be within a specific range for example 0 -100 or 0 - 1

#Feature Scaling
from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
X_train = sc.fit_transform(X_train)
X_test = sc.transform(X_test)
```


```python
def models(X_train,Y_train):


  #Using Logistic Regression Algorithm to the Training Set
  from sklearn.linear_model import LogisticRegression
  log = LogisticRegression(random_state = 0)
  log.fit(X_train, Y_train)

  #Using KNeighborsClassifier Method of neighbors class to use Nearest Neighbor algorithm
  from sklearn.neighbors import KNeighborsClassifier
  knn = KNeighborsClassifier(n_neighbors = 5, metric = 'minkowski', p = 2)
  knn.fit(X_train, Y_train)

  #Using SVC method of svm class to use Support Vector Machine Algorithm
  from sklearn.svm import SVC
  svc_lin = SVC(kernel = 'linear', random_state = 0)
  svc_lin.fit(X_train, Y_train)

  #Using SVC method of svm class to use Kernel SVM Algorithm
  from sklearn.svm import SVC
  svc_rbf = SVC(kernel = 'rbf', random_state = 0)
  svc_rbf.fit(X_train, Y_train)

  #Using GaussianNB method of naïve_bayes class to use Naïve Bayes Algorithm
  from sklearn.naive_bayes import GaussianNB
  gauss = GaussianNB()
  gauss.fit(X_train, Y_train)

  #Using DecisionTreeClassifier of tree class to use Decision Tree Algorithm
  from sklearn.tree import DecisionTreeClassifier
  tree = DecisionTreeClassifier(criterion = 'entropy', random_state = 0)
  tree.fit(X_train, Y_train)

  #Using RandomForestClassifier method of ensemble class to use Random Forest Classification algorithm
  from sklearn.ensemble import RandomForestClassifier
  forest = RandomForestClassifier(n_estimators = 10, criterion = 'entropy', random_state = 0)
  forest.fit(X_train, Y_train)

  #print model accuracy on the training data.
  print('[0]Logistic Regression Training Accuracy:', log.score(X_train, Y_train))
  print('[1]K Nearest Neighbor Training Accuracy:', knn.score(X_train, Y_train))
  print('[2]Support Vector Machine (Linear Classifier) Training Accuracy:', svc_lin.score(X_train, Y_train))
  print('[3]Support Vector Machine (RBF Classifier) Training Accuracy:', svc_rbf.score(X_train, Y_train))
  print('[4]Gaussian Naive Bayes Training Accuracy:', gauss.score(X_train, Y_train))
  print('[5]Decision Tree Classifier Training Accuracy:', tree.score(X_train, Y_train))
  print('[6]Random Forest Classifier Training Accuracy:', forest.score(X_train, Y_train))

  return log, knn, svc_lin, svc_rbf, gauss, tree, forest
```


```python
#Get and train all of the models
model = models(X_train,Y_train)
```

    [0]Logistic Regression Training Accuracy: 0.8314606741573034
    [1]K Nearest Neighbor Training Accuracy: 0.8553370786516854
    [2]Support Vector Machine (Linear Classifier) Training Accuracy: 0.8286516853932584
    [3]Support Vector Machine (RBF Classifier) Training Accuracy: 0.848314606741573
    [4]Gaussian Naive Bayes Training Accuracy: 0.7823033707865169
    [5]Decision Tree Classifier Training Accuracy: 0.901685393258427
    [6]Random Forest Classifier Training Accuracy: 0.8932584269662921



```python
#Show the confusion matrix and accuracy for all of the models on the test data
#Classification accuracy is the ratio of correct predictions to total predictions made.
from sklearn.metrics import confusion_matrix
for i in range(len(model)):
  cm = confusion_matrix(Y_test, model[i].predict(X_test))

  #extracting true_positives, false_positives, true_negatives, false_negatives
  TN, FP, FN, TP = confusion_matrix(Y_test, model[i].predict(X_test)).ravel()

  print(cm)
  print('Model[{}] Testing Accuracy = "{} !"'.format(i,  (TP + TN) / (TP + TN + FN + FP)))
  print()# Print a new line
```

    [[92 18]
     [17 52]]
    Model[0] Testing Accuracy = "0.8044692737430168 !"

    [[97 13]
     [20 49]]
    Model[1] Testing Accuracy = "0.8156424581005587 !"

    [[91 19]
     [17 52]]
    Model[2] Testing Accuracy = "0.7988826815642458 !"

    [[100  10]
     [ 22  47]]
    Model[3] Testing Accuracy = "0.8212290502793296 !"

    [[82 28]
     [ 7 62]]
    Model[4] Testing Accuracy = "0.8044692737430168 !"

    [[97 13]
     [25 44]]
    Model[5] Testing Accuracy = "0.7877094972067039 !"

    [[100  10]
     [ 23  46]]
    Model[6] Testing Accuracy = "0.8156424581005587 !"




```python
#Get Feature importance
forest=model[6]
importances = pd.DataFrame({'feature':train_data.iloc[:,0:8].columns, 'importance': np.round(forest.feature_importances_, 3)})
importances= importances.sort_values('importance', ascending=False).set_index('feature')
importances
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>importance</th>
    </tr>
    <tr>
      <th>feature</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Title</td>
      <td>0.257</td>
    </tr>
    <tr>
      <td>Sex</td>
      <td>0.135</td>
    </tr>
    <tr>
      <td>FamilySize</td>
      <td>0.129</td>
    </tr>
    <tr>
      <td>Age</td>
      <td>0.127</td>
    </tr>
    <tr>
      <td>Cabin</td>
      <td>0.107</td>
    </tr>
    <tr>
      <td>Fare</td>
      <td>0.097</td>
    </tr>
    <tr>
      <td>Pclass</td>
      <td>0.084</td>
    </tr>
    <tr>
      <td>Embarked</td>
      <td>0.064</td>
    </tr>
  </tbody>
</table>
</div>




```python
#Visualize the importance
importances.plot.bar()
```




    <matplotlib.axes._subplots.AxesSubplot at 0x1be649b7b48>




![png](output_144_1.png)



```python
#print the prediction of the random forest classifier
pred = model[6].predict(X_test)
print(pred)

print()

#print the actual value
print(Y_test)
```

    [0 0 0 1 0 0 1 1 0 1 0 1 0 1 1 1 0 0 0 1 0 1 0 0 1 1 0 1 1 0 0 1 0 0 0 0 0
     0 0 0 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 1 1 1 0 0 0
     0 1 0 0 0 1 0 1 1 0 0 1 1 0 1 0 0 0 1 1 0 0 1 0 1 0 0 0 0 0 0 1 1 0 0 1 0
     1 0 1 0 1 1 1 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 1 1 1 0 1
     1 0 0 0 0 0 1 0 0 0 1 1 0 0 1 0 0 0 0 0 0 0 0 1 0 0 1 0 1 0 0]

    495    0
    648    0
    278    0
    31     1
    255    1
          ..
    780    1
    837    0
    215    1
    833    0
    372    0
    Name: Survived, Length: 179, dtype: int64



```python
#my survival
#Pclass	Sex	Age	Fare	Cabin	Embarked	Title	FamilySize

#scaling my survival
my_survival = [[2, 0, 3, 2, 0.8, 0, 0, 0.8]]

#scaling:
from sklearn.preprocessing import StandardScaler
sc = StandardScaler()
my_survival_scaled = sc.fit_transform(my_survival)

#print prediction of my survival using Random forest calssifier:
pred= model[6].predict(my_survival_scaled)

print(pred)

if pred  == 0:
    print('Oh no you didn not survive')
else:
    print('nice! you survived!')

```

    [1]
    nice! you survived!


### ROC and AUC using logistic regression as an example


```python
  #Using Logistic Regression Algorithm to the Training Set
  from sklearn.linear_model import LogisticRegression
  log = LogisticRegression(random_state = 0)
  log.fit(X_train, Y_train)
Y_predict=log.predict(X_test)
```


```python
from sklearn.metrics import accuracy_score
print(accuracy_score(Y_test,Y_predict))
pd.crosstab(Y_test, Y_predict)
```

    0.8044692737430168





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>92</td>
      <td>18</td>
    </tr>
    <tr>
      <td>1</td>
      <td>17</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>




```python
log.predict_proba(X_test)
```




    array([[0.90562449, 0.09437551],
           [0.92146315, 0.07853685],
           [0.66984458, 0.33015542],
           [0.03898146, 0.96101854],
           [0.39961516, 0.60038484],
           [0.56001427, 0.43998573],
           [0.09451128, 0.90548872],
           [0.13543067, 0.86456933],
           [0.52243664, 0.47756336],
           [0.21745097, 0.78254903],
           [0.91920705, 0.08079295],
           [0.31239561, 0.68760439],
           [0.8869834 , 0.1130166 ],
           [0.176777  , 0.823223  ],
           [0.04009628, 0.95990372],
           [0.22778632, 0.77221368],
           [0.88025683, 0.11974317],
           [0.81108283, 0.18891717],
           [0.92146315, 0.07853685],
           [0.3501963 , 0.6498037 ],
           [0.73578675, 0.26421325],
           [0.03936127, 0.96063873],
           [0.8869834 , 0.1130166 ],
           [0.56001427, 0.43998573],
           [0.32009766, 0.67990234],
           [0.07297558, 0.92702442],
           [0.92146315, 0.07853685],
           [0.32009766, 0.67990234],
           [0.09101505, 0.90898495],
           [0.67756724, 0.32243276],
           [0.90562449, 0.09437551],
           [0.31239561, 0.68760439],
           [0.92146315, 0.07853685],
           [0.56001427, 0.43998573],
           [0.9478045 , 0.0521955 ],
           [0.53010852, 0.46989148],
           [0.94930607, 0.05069393],
           [0.8163354 , 0.1836646 ],
           [0.73578675, 0.26421325],
           [0.87645115, 0.12354885],
           [0.81178102, 0.18821898],
           [0.85739412, 0.14260588],
           [0.92146315, 0.07853685],
           [0.96340222, 0.03659778],
           [0.05396473, 0.94603527],
           [0.92146315, 0.07853685],
           [0.92146315, 0.07853685],
           [0.17244067, 0.82755933],
           [0.87645115, 0.12354885],
           [0.80556426, 0.19443574],
           [0.5941448 , 0.4058552 ],
           [0.48225335, 0.51774665],
           [0.176777  , 0.823223  ],
           [0.88025683, 0.11974317],
           [0.56475591, 0.43524409],
           [0.81108283, 0.18891717],
           [0.71688627, 0.28311373],
           [0.72293216, 0.27706784],
           [0.75205183, 0.24794817],
           [0.93781784, 0.06218216],
           [0.85739412, 0.14260588],
           [0.60996825, 0.39003175],
           [0.13191367, 0.86808633],
           [0.51004073, 0.48995927],
           [0.44867709, 0.55132291],
           [0.8869834 , 0.1130166 ],
           [0.24865623, 0.75134377],
           [0.15615491, 0.84384509],
           [0.176777  , 0.823223  ],
           [0.06453911, 0.93546089],
           [0.09101505, 0.90898495],
           [0.75868937, 0.24131063],
           [0.61702161, 0.38297839],
           [0.92146315, 0.07853685],
           [0.88025683, 0.11974317],
           [0.27682631, 0.72317369],
           [0.85032561, 0.14967439],
           [0.67436994, 0.32563006],
           [0.92146315, 0.07853685],
           [0.78425929, 0.21574071],
           [0.90693144, 0.09306856],
           [0.50490792, 0.49509208],
           [0.13417399, 0.86582601],
           [0.82161595, 0.17838405],
           [0.8505506 , 0.1494494 ],
           [0.04500599, 0.95499401],
           [0.07865182, 0.92134818],
           [0.46394494, 0.53605506],
           [0.11003162, 0.88996838],
           [0.44746386, 0.55253614],
           [0.68184598, 0.31815402],
           [0.88025683, 0.11974317],
           [0.22942292, 0.77057708],
           [0.0746709 , 0.9253291 ],
           [0.67756724, 0.32243276],
           [0.90562449, 0.09437551],
           [0.16189054, 0.83810946],
           [0.96340222, 0.03659778],
           [0.09570488, 0.90429512],
           [0.48994053, 0.51005947],
           [0.98438827, 0.01561173],
           [0.26908461, 0.73091539],
           [0.88025683, 0.11974317],
           [0.94626097, 0.05373903],
           [0.42887836, 0.57112164],
           [0.39500171, 0.60499829],
           [0.11403093, 0.88596907],
           [0.75605068, 0.24394932],
           [0.77567238, 0.22432762],
           [0.32768611, 0.67231389],
           [0.94930607, 0.05069393],
           [0.06305814, 0.93694186],
           [0.88306269, 0.11693731],
           [0.32009766, 0.67990234],
           [0.80401578, 0.19598422],
           [0.22158155, 0.77841845],
           [0.2478141 , 0.7521859 ],
           [0.02291349, 0.97708651],
           [0.94930607, 0.05069393],
           [0.283029  , 0.716971  ],
           [0.88306269, 0.11693731],
           [0.8869834 , 0.1130166 ],
           [0.88025683, 0.11974317],
           [0.11654445, 0.88345555],
           [0.92146315, 0.07853685],
           [0.69177453, 0.30822547],
           [0.90562449, 0.09437551],
           [0.91920705, 0.08079295],
           [0.8163354 , 0.1836646 ],
           [0.22869217, 0.77130783],
           [0.23949934, 0.76050066],
           [0.88025683, 0.11974317],
           [0.88025683, 0.11974317],
           [0.42151289, 0.57848711],
           [0.80164361, 0.19835639],
           [0.88025683, 0.11974317],
           [0.92393466, 0.07606534],
           [0.45630075, 0.54369925],
           [0.8980445 , 0.1019555 ],
           [0.73578675, 0.26421325],
           [0.8163354 , 0.1836646 ],
           [0.07782203, 0.92217797],
           [0.92146315, 0.07853685],
           [0.23949934, 0.76050066],
           [0.10297104, 0.89702896],
           [0.32009766, 0.67990234],
           [0.8163354 , 0.1836646 ],
           [0.20322749, 0.79677251],
           [0.06080351, 0.93919649],
           [0.92146315, 0.07853685],
           [0.75868937, 0.24131063],
           [0.42903417, 0.57096583],
           [0.54530973, 0.45469027],
           [0.92146315, 0.07853685],
           [0.12729888, 0.87270112],
           [0.73578675, 0.26421325],
           [0.40702062, 0.59297938],
           [0.87645115, 0.12354885],
           [0.23949934, 0.76050066],
           [0.4177658 , 0.5822342 ],
           [0.92146315, 0.07853685],
           [0.85739412, 0.14260588],
           [0.06930139, 0.93069861],
           [0.5574304 , 0.4425696 ],
           [0.90023128, 0.09976872],
           [0.88025683, 0.11974317],
           [0.94930607, 0.05069393],
           [0.88025683, 0.11974317],
           [0.88025683, 0.11974317],
           [0.88025683, 0.11974317],
           [0.94930607, 0.05069393],
           [0.06930139, 0.93069861],
           [0.92146315, 0.07853685],
           [0.92146315, 0.07853685],
           [0.19436312, 0.80563688],
           [0.92146315, 0.07853685],
           [0.07096286, 0.92903714],
           [0.88025683, 0.11974317],
           [0.88025683, 0.11974317]])




```python
log.predict_proba(X_test)[:,1]
```




    array([0.09437551, 0.07853685, 0.33015542, 0.96101854, 0.60038484,
           0.43998573, 0.90548872, 0.86456933, 0.47756336, 0.78254903,
           0.08079295, 0.68760439, 0.1130166 , 0.823223  , 0.95990372,
           0.77221368, 0.11974317, 0.18891717, 0.07853685, 0.6498037 ,
           0.26421325, 0.96063873, 0.1130166 , 0.43998573, 0.67990234,
           0.92702442, 0.07853685, 0.67990234, 0.90898495, 0.32243276,
           0.09437551, 0.68760439, 0.07853685, 0.43998573, 0.0521955 ,
           0.46989148, 0.05069393, 0.1836646 , 0.26421325, 0.12354885,
           0.18821898, 0.14260588, 0.07853685, 0.03659778, 0.94603527,
           0.07853685, 0.07853685, 0.82755933, 0.12354885, 0.19443574,
           0.4058552 , 0.51774665, 0.823223  , 0.11974317, 0.43524409,
           0.18891717, 0.28311373, 0.27706784, 0.24794817, 0.06218216,
           0.14260588, 0.39003175, 0.86808633, 0.48995927, 0.55132291,
           0.1130166 , 0.75134377, 0.84384509, 0.823223  , 0.93546089,
           0.90898495, 0.24131063, 0.38297839, 0.07853685, 0.11974317,
           0.72317369, 0.14967439, 0.32563006, 0.07853685, 0.21574071,
           0.09306856, 0.49509208, 0.86582601, 0.17838405, 0.1494494 ,
           0.95499401, 0.92134818, 0.53605506, 0.88996838, 0.55253614,
           0.31815402, 0.11974317, 0.77057708, 0.9253291 , 0.32243276,
           0.09437551, 0.83810946, 0.03659778, 0.90429512, 0.51005947,
           0.01561173, 0.73091539, 0.11974317, 0.05373903, 0.57112164,
           0.60499829, 0.88596907, 0.24394932, 0.22432762, 0.67231389,
           0.05069393, 0.93694186, 0.11693731, 0.67990234, 0.19598422,
           0.77841845, 0.7521859 , 0.97708651, 0.05069393, 0.716971  ,
           0.11693731, 0.1130166 , 0.11974317, 0.88345555, 0.07853685,
           0.30822547, 0.09437551, 0.08079295, 0.1836646 , 0.77130783,
           0.76050066, 0.11974317, 0.11974317, 0.57848711, 0.19835639,
           0.11974317, 0.07606534, 0.54369925, 0.1019555 , 0.26421325,
           0.1836646 , 0.92217797, 0.07853685, 0.76050066, 0.89702896,
           0.67990234, 0.1836646 , 0.79677251, 0.93919649, 0.07853685,
           0.24131063, 0.57096583, 0.45469027, 0.07853685, 0.87270112,
           0.26421325, 0.59297938, 0.12354885, 0.76050066, 0.5822342 ,
           0.07853685, 0.14260588, 0.93069861, 0.4425696 , 0.09976872,
           0.11974317, 0.05069393, 0.11974317, 0.11974317, 0.11974317,
           0.05069393, 0.93069861, 0.07853685, 0.07853685, 0.80563688,
           0.07853685, 0.92903714, 0.11974317, 0.11974317])




```python
np.where(log.predict_proba(X_test)[:,1] >0.3,1,0) #threshold 0.3
```




    array([0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 0, 1, 0, 1,
           0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0,
           1, 0, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,
           1, 1, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1,
           1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 1, 0, 0, 1,
           0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0,
           0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0,
           1, 0, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0,
           1, 0, 0])




```python
th3= np.where(log.predict_proba(X_test)[:,1] >0.3,1,0) #threshold 0.3
th4=np.where(log.predict_proba(X_test)[:,1] >0.4,1,0) #threshold 0.4
th5=np.where(log.predict_proba(X_test)[:,1] >0.5,1,0) #threshold 0.5
th6=np.where(log.predict_proba(X_test)[:,1] >0.6,1,0) #threshold 0.6
th8=np.where(log.predict_proba(X_test)[:,1] >0.8,1,0) #threshold 0.6

```


```python
pd.crosstab(Y_test, th3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>81</td>
      <td>29</td>
    </tr>
    <tr>
      <td>1</td>
      <td>9</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(Y_test, th4)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>89</td>
      <td>21</td>
    </tr>
    <tr>
      <td>1</td>
      <td>9</td>
      <td>60</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(Y_test, th5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>92</td>
      <td>18</td>
    </tr>
    <tr>
      <td>1</td>
      <td>17</td>
      <td>52</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(Y_test, th6)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>col_0</th>
      <th>0</th>
      <th>1</th>
    </tr>
    <tr>
      <th>Survived</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>97</td>
      <td>13</td>
    </tr>
    <tr>
      <td>1</td>
      <td>23</td>
      <td>46</td>
    </tr>
  </tbody>
</table>
</div>




```python
def predict_thrs (log,X_test,thrs):
    import numpy as np
    Y_predict = np.where(log.predict_proba(X_test)[:,1] >thrs,1,0)
    return Y_predict
```


```python
import numpy as np
from sklearn.metrics import confusion_matrix
for thr in np.arange(0,1.1,0.1):
    Y_predict= predict_thrs(log, X_test,thr)
    print("Threshold :", thr)
    print(confusion_matrix(Y_test, Y_predict))
```

    Threshold : 0.0
    [[  0 110]
     [  0  69]]
    Threshold : 0.1
    [[35 75]
     [ 2 67]]
    Threshold : 0.2
    [[70 40]
     [ 8 61]]
    Threshold : 0.30000000000000004
    [[81 29]
     [ 9 60]]
    Threshold : 0.4
    [[89 21]
     [ 9 60]]
    Threshold : 0.5
    [[92 18]
     [17 52]]
    Threshold : 0.6000000000000001
    [[97 13]
     [23 46]]
    Threshold : 0.7000000000000001
    [[100  10]
     [ 30  39]]
    Threshold : 0.8
    [[106   4]
     [ 38  31]]
    Threshold : 0.9
    [[109   1]
     [ 50  19]]
    Threshold : 1.0
    [[110   0]
     [ 69   0]]



```python
from sklearn.metrics import roc_curve, roc_auc_score
```


```python
tpr,fpr,thrs= roc_curve(Y_test, log.predict_proba(X_test)[:,1])
```


```python
tpr
```




    array([0.        , 0.        , 0.        , 0.        , 0.        ,
           0.        , 0.        , 0.00909091, 0.00909091, 0.01818182,
           0.01818182, 0.02727273, 0.02727273, 0.03636364, 0.03636364,
           0.03636364, 0.03636364, 0.05454545, 0.05454545, 0.08181818,
           0.08181818, 0.09090909, 0.09090909, 0.09090909, 0.11818182,
           0.11818182, 0.12727273, 0.12727273, 0.14545455, 0.14545455,
           0.15454545, 0.15454545, 0.16363636, 0.16363636, 0.17272727,
           0.17272727, 0.18181818, 0.18181818, 0.19090909, 0.19090909,
           0.22727273, 0.24545455, 0.28181818, 0.31818182, 0.33636364,
           0.34545455, 0.37272727, 0.37272727, 0.38181818, 0.4       ,
           0.4       , 0.43636364, 0.46363636, 0.5       , 0.63636364,
           0.63636364, 0.67272727, 0.69090909, 0.72727273, 0.73636364,
           0.74545455, 0.9       , 0.90909091, 0.90909091, 0.92727273,
           0.97272727, 0.99090909, 1.        ])




```python
fpr
```




    array([0.        , 0.01449275, 0.13043478, 0.15942029, 0.23188406,
           0.26086957, 0.27536232, 0.27536232, 0.31884058, 0.31884058,
           0.34782609, 0.34782609, 0.36231884, 0.36231884, 0.39130435,
           0.43478261, 0.49275362, 0.49275362, 0.50724638, 0.50724638,
           0.53623188, 0.53623188, 0.56521739, 0.5942029 , 0.60869565,
           0.66666667, 0.66666667, 0.68115942, 0.68115942, 0.69565217,
           0.69565217, 0.71014493, 0.71014493, 0.76811594, 0.76811594,
           0.79710145, 0.79710145, 0.8115942 , 0.84057971, 0.86956522,
           0.86956522, 0.86956522, 0.86956522, 0.86956522, 0.86956522,
           0.88405797, 0.88405797, 0.89855072, 0.89855072, 0.89855072,
           0.91304348, 0.91304348, 0.91304348, 0.94202899, 0.94202899,
           0.97101449, 0.97101449, 0.97101449, 0.97101449, 0.97101449,
           0.98550725, 0.98550725, 0.98550725, 1.        , 1.        ,
           1.        , 1.        , 1.        ])




```python
thrs
```




    array([1.97708651, 0.97708651, 0.93546089, 0.93069861, 0.92134818,
           0.90898495, 0.90548872, 0.90429512, 0.88596907, 0.88345555,
           0.86808633, 0.86582601, 0.86456933, 0.84384509, 0.82755933,
           0.823223  , 0.77841845, 0.77130783, 0.77057708, 0.76050066,
           0.75134377, 0.73091539, 0.716971  , 0.68760439, 0.67990234,
           0.60038484, 0.59297938, 0.5822342 , 0.57112164, 0.57096583,
           0.55253614, 0.55132291, 0.54369925, 0.49509208, 0.48995927,
           0.46989148, 0.45469027, 0.4425696 , 0.43998573, 0.4058552 ,
           0.32563006, 0.32243276, 0.27706784, 0.26421325, 0.24394932,
           0.24131063, 0.19835639, 0.19598422, 0.19443574, 0.18891717,
           0.18821898, 0.1836646 , 0.1494494 , 0.12354885, 0.11974317,
           0.11693731, 0.1130166 , 0.09976872, 0.09437551, 0.09306856,
           0.08079295, 0.07853685, 0.07606534, 0.06218216, 0.0521955 ,
           0.05069393, 0.03659778, 0.01561173])




```python
import matplotlib.pyplot as plt
from sklearn.metrics import roc_curve,roc_auc_score
%matplotlib inline
fpr,tpr,thrs= roc_curve(Y_test, log.predict_proba(X_test)[:,1])
plt.xlim([0.0,1.0])
plt.ylim([0.0,1.0])
plt.plot(fpr,tpr,color='red')
plt.show()
```


![png](output_165_0.png)



```python
roc_auc_score(Y_test, log.predict_proba(X_test)[:,1])
```




    0.8704216073781291



### 5.2 Unsupervised learning:

#### 5.2.1 Kmeans


```python
from sklearn.cluster import KMeans
import pandas as pd
from sklearn.preprocessing import MinMaxScaler
from matplotlib import pyplot as plt
%matplotlib inline
```


```python
df = pd.read_csv('Unsupervised.csv')
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>7.2500</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>71.2833</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>7.9250</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>53.1000</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>8.0500</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.isnull().sum()
```




    Name      0
    Age     177
    Fare      0
    dtype: int64




```python
df['Initial']=0
for i in df:
    df['Initial']=df.Name.str.extract('([A-Za-z]+)\.') #extracting Name initials
```


```python
pd.crosstab(df.Initial,train_data.Sex).T.style.background_gradient(cmap='summer_r')

```




<style  type="text/css" >
    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col0 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col1 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col2 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col3 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col4 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col5 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col6 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col7 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col8 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col9 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col10 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col11 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col12 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col13 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col14 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col15 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col16 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col0 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col1 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col2 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col3 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col4 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col5 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col6 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col7 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col8 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col9 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col10 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col11 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col12 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col13 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col14 {
            background-color:  #008066;
            color:  #f1f1f1;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col15 {
            background-color:  #ffff66;
            color:  #000000;
        }    #T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col16 {
            background-color:  #ffff66;
            color:  #000000;
        }</style><table id="T_37921658_627f_11ea_b12f_c0b6f9c05084" ><thead>    <tr>        <th class="index_name level0" >Initial</th>        <th class="col_heading level0 col0" >Capt</th>        <th class="col_heading level0 col1" >Col</th>        <th class="col_heading level0 col2" >Countess</th>        <th class="col_heading level0 col3" >Don</th>        <th class="col_heading level0 col4" >Dr</th>        <th class="col_heading level0 col5" >Jonkheer</th>        <th class="col_heading level0 col6" >Lady</th>        <th class="col_heading level0 col7" >Major</th>        <th class="col_heading level0 col8" >Master</th>        <th class="col_heading level0 col9" >Miss</th>        <th class="col_heading level0 col10" >Mlle</th>        <th class="col_heading level0 col11" >Mme</th>        <th class="col_heading level0 col12" >Mr</th>        <th class="col_heading level0 col13" >Mrs</th>        <th class="col_heading level0 col14" >Ms</th>        <th class="col_heading level0 col15" >Rev</th>        <th class="col_heading level0 col16" >Sir</th>    </tr>    <tr>        <th class="index_name level0" >Sex</th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>        <th class="blank" ></th>    </tr></thead><tbody>
                <tr>
                        <th id="T_37921658_627f_11ea_b12f_c0b6f9c05084level0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col0" class="data row0 col0" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col1" class="data row0 col1" >2</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col2" class="data row0 col2" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col3" class="data row0 col3" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col4" class="data row0 col4" >6</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col5" class="data row0 col5" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col6" class="data row0 col6" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col7" class="data row0 col7" >2</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col8" class="data row0 col8" >40</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col9" class="data row0 col9" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col10" class="data row0 col10" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col11" class="data row0 col11" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col12" class="data row0 col12" >517</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col13" class="data row0 col13" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col14" class="data row0 col14" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col15" class="data row0 col15" >6</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row0_col16" class="data row0 col16" >1</td>
            </tr>
            <tr>
                        <th id="T_37921658_627f_11ea_b12f_c0b6f9c05084level0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col0" class="data row1 col0" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col1" class="data row1 col1" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col2" class="data row1 col2" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col3" class="data row1 col3" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col4" class="data row1 col4" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col5" class="data row1 col5" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col6" class="data row1 col6" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col7" class="data row1 col7" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col8" class="data row1 col8" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col9" class="data row1 col9" >182</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col10" class="data row1 col10" >2</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col11" class="data row1 col11" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col12" class="data row1 col12" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col13" class="data row1 col13" >125</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col14" class="data row1 col14" >1</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col15" class="data row1 col15" >0</td>
                        <td id="T_37921658_627f_11ea_b12f_c0b6f9c05084row1_col16" class="data row1 col16" >0</td>
            </tr>
    </tbody></table>




```python
df['Initial'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','Countess',
                               'Jonkheer','Col','Rev','Capt','Sir','Don'],['Miss',
                                'Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)
```


```python
df.groupby('Initial')['Age'].mean()
```




    Initial
    Master     4.574167
    Miss      21.860000
    Mr        32.739609
    Mrs       35.981818
    Other     45.888889
    Name: Age, dtype: float64




```python
df.loc[(df.Age.isnull()) & (df.Initial=='Mr'),'Age']=33
df.loc[(df.Age.isnull()) & (df.Initial=='Mrs'),'Age']=36
df.loc[(df.Age.isnull()) & (df.Initial=='Master'),'Age']=5
df.loc[(df.Age.isnull()) & (df.Initial=='Miss'),'Age']=22
df.loc[(df.Age.isnull()) & (df.Initial=='Other'),'Age']=46
```


```python
df.Age.isnull().any()
```




    False




```python
plt.scatter(df.Age,df.Fare)
```




    <matplotlib.collections.PathCollection at 0x1be6786f688>




![png](output_179_1.png)



```python
km = KMeans(n_clusters=3)
km
```




    KMeans(algorithm='auto', copy_x=True, init='k-means++', max_iter=300,
           n_clusters=3, n_init=10, n_jobs=None, precompute_distances='auto',
           random_state=None, tol=0.0001, verbose=0)




```python
y_predicted= km.fit_predict(df[['Age','Fare']])
y_predicted
```




    array([1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 2, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           2, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
           0, 1, 1, 1, 1, 1, 1, 1, 2, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1,
           1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1,
           1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1,
           1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 2, 1, 1, 1, 0, 1,
           1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 0, 1, 2, 1, 1, 1, 1, 1, 0, 0, 0,
           1, 0, 0, 2, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 0,
           1, 1, 0, 1, 0, 1, 0, 0, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0,
           1, 0, 1, 2, 1, 1, 2, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 2, 1,
           1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
           0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0,
           1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 2,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1,
           0, 1, 1, 1, 1, 1, 1, 2, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0,
           1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 1,
           1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0,
           1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
           1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0,
           0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 2, 1, 0,
           1, 1, 1, 1, 1, 1, 1, 2, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 2, 1, 1, 1,
           1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 0, 1,
           1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 1, 0, 2, 1, 1, 0, 1, 1,
           0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1,
           0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1,
           1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,
           1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1,
           1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0,
           1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])




```python
df['cluster']=y_predicted
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>7.2500</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>71.2833</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>7.9250</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>53.1000</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>8.0500</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
%pylab inline

```

    Populating the interactive namespace from numpy and matplotlib



```python
df1=df[df.cluster==0]
df2=df[df.cluster==1]
df3=df[df.cluster==2]
plt.scatter(df1.Age,df1['Fare'],color = 'green')
plt.scatter(df2.Age,df2['Fare'],color = 'red')
plt.scatter(df3.Age,df3['Fare'],color = 'black')
plt.xlabel('Age')
plt.ylabel('Fare')
plt.legend()
```

    No handles with labels found to put in legend.





    <matplotlib.legend.Legend at 0x1be67b69188>




![png](output_184_2.png)



```python
df1=df[df.cluster==0]
df2=df[df.cluster==1]
df3=df[df.cluster==2]
plt.scatter(df1['Fare'],df1.Age,color = 'green')
plt.scatter(df2['Fare'],df2.Age,color = 'red')
plt.scatter(df3['Fare'],df3.Age,color = 'black')
plt.ylabel('Age')
plt.xlabel('Fare')
plt.legend()
```

    No handles with labels found to put in legend.





    <matplotlib.legend.Legend at 0x1be677f7fc8>




![png](output_185_2.png)



```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>7.2500</td>
      <td>Mr</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>71.2833</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>7.9250</td>
      <td>Miss</td>
      <td>2</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>53.1000</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>8.0500</td>
      <td>Mr</td>
      <td>2</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>Montvila, Rev. Juozas</td>
      <td>27.0</td>
      <td>13.0000</td>
      <td>Other</td>
      <td>2</td>
    </tr>
    <tr>
      <td>887</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>19.0</td>
      <td>30.0000</td>
      <td>Miss</td>
      <td>2</td>
    </tr>
    <tr>
      <td>888</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>22.0</td>
      <td>23.4500</td>
      <td>Miss</td>
      <td>2</td>
    </tr>
    <tr>
      <td>889</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>26.0</td>
      <td>30.0000</td>
      <td>Mr</td>
      <td>2</td>
    </tr>
    <tr>
      <td>890</td>
      <td>Dooley, Mr. Patrick</td>
      <td>32.0</td>
      <td>7.7500</td>
      <td>Mr</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 5 columns</p>
</div>




```python
sc=MinMaxScaler()
sc.fit(df[['Age']])
df['Age']=sc.transform(df[['Age']])
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>0.271174</td>
      <td>7.2500</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>0.472229</td>
      <td>71.2833</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>0.321438</td>
      <td>7.9250</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>0.434531</td>
      <td>53.1000</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>0.434531</td>
      <td>8.0500</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>Montvila, Rev. Juozas</td>
      <td>0.334004</td>
      <td>13.0000</td>
      <td>Other</td>
      <td>1</td>
    </tr>
    <tr>
      <td>887</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>0.233476</td>
      <td>30.0000</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>888</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>0.271174</td>
      <td>23.4500</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>889</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>0.321438</td>
      <td>30.0000</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>890</td>
      <td>Dooley, Mr. Patrick</td>
      <td>0.396833</td>
      <td>7.7500</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 5 columns</p>
</div>




```python
sc=MinMaxScaler()
sc.fit(df[['Fare']])
df['Fare']=sc.transform(df[['Fare']])
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>0.271174</td>
      <td>0.014151</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>0.472229</td>
      <td>0.139136</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>0.321438</td>
      <td>0.015469</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>0.434531</td>
      <td>0.103644</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>0.434531</td>
      <td>0.015713</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>Montvila, Rev. Juozas</td>
      <td>0.334004</td>
      <td>0.025374</td>
      <td>Other</td>
      <td>1</td>
    </tr>
    <tr>
      <td>887</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>0.233476</td>
      <td>0.058556</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>888</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>0.271174</td>
      <td>0.045771</td>
      <td>Miss</td>
      <td>1</td>
    </tr>
    <tr>
      <td>889</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>0.321438</td>
      <td>0.058556</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
    <tr>
      <td>890</td>
      <td>Dooley, Mr. Patrick</td>
      <td>0.396833</td>
      <td>0.015127</td>
      <td>Mr</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 5 columns</p>
</div>




```python
km= KMeans(n_clusters=3)
y_predicted = km.fit_predict(df[['Age', 'Fare']])
y_predicted
```




    array([2, 0, 0, 0, 0, 0, 1, 2, 0, 2, 2, 1, 2, 0, 2, 1, 2, 0, 0, 0, 0, 0,
           2, 0, 2, 0, 0, 2, 2, 0, 0, 0, 2, 1, 0, 1, 0, 2, 2, 2, 0, 0, 0, 2,
           2, 0, 0, 2, 0, 2, 2, 2, 1, 0, 1, 0, 2, 0, 2, 2, 2, 0, 1, 2, 0, 2,
           0, 2, 2, 0, 0, 2, 2, 0, 0, 0, 0, 0, 2, 0, 2, 0, 2, 0, 2, 0, 2, 0,
           2, 2, 0, 2, 1, 0, 1, 0, 1, 2, 0, 0, 0, 0, 2, 0, 0, 0, 2, 0, 0, 2,
           1, 2, 2, 2, 2, 2, 1, 0, 2, 2, 2, 0, 0, 0, 1, 2, 0, 2, 2, 1, 0, 2,
           1, 0, 0, 2, 2, 0, 2, 2, 0, 2, 2, 2, 2, 2, 0, 2, 0, 0, 1, 2, 1, 0,
           0, 1, 2, 0, 0, 2, 1, 0, 0, 2, 2, 2, 0, 1, 0, 0, 1, 2, 2, 2, 1, 2,
           2, 1, 0, 0, 2, 0, 2, 2, 2, 0, 0, 1, 0, 0, 0, 2, 2, 2, 1, 1, 0, 0,
           2, 2, 0, 0, 0, 1, 2, 2, 0, 0, 2, 0, 2, 0, 2, 0, 0, 0, 0, 0, 0, 0,
           2, 0, 1, 0, 0, 2, 2, 2, 2, 2, 0, 0, 1, 2, 2, 2, 1, 2, 2, 0, 2, 2,
           0, 2, 0, 1, 0, 2, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 2, 1, 0,
           2, 0, 2, 0, 1, 0, 0, 0, 0, 0, 2, 1, 1, 0, 2, 0, 1, 0, 2, 2, 0, 0,
           0, 2, 0, 2, 0, 2, 0, 2, 2, 0, 2, 2, 0, 1, 2, 0, 2, 2, 0, 2, 2, 2,
           0, 0, 2, 2, 0, 0, 1, 0, 2, 1, 0, 1, 2, 0, 0, 2, 0, 0, 1, 0, 0, 2,
           2, 1, 1, 2, 0, 0, 0, 1, 1, 1, 2, 2, 0, 0, 0, 2, 0, 0, 2, 0, 2, 0,
           2, 0, 0, 0, 2, 0, 2, 2, 0, 0, 1, 0, 0, 0, 1, 0, 2, 2, 0, 2, 2, 2,
           2, 0, 2, 0, 2, 2, 1, 2, 0, 0, 0, 2, 2, 0, 0, 2, 0, 2, 0, 2, 2, 2,
           0, 1, 2, 0, 0, 0, 2, 0, 2, 0, 1, 2, 2, 2, 0, 0, 0, 0, 1, 0, 0, 2,
           0, 2, 0, 2, 0, 0, 2, 0, 0, 2, 0, 0, 0, 0, 0, 2, 1, 2, 2, 2, 1, 0,
           1, 2, 0, 0, 0, 2, 2, 0, 2, 1, 0, 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0,
           1, 1, 0, 0, 0, 1, 0, 2, 0, 0, 0, 2, 2, 0, 0, 0, 2, 2, 2, 0, 1, 1,
           2, 2, 0, 1, 0, 2, 0, 2, 1, 1, 2, 0, 1, 0, 2, 2, 2, 2, 2, 0, 2, 2,
           0, 0, 0, 0, 0, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 2, 0, 1, 0, 0, 1, 0,
           0, 2, 2, 0, 2, 0, 0, 2, 1, 0, 0, 2, 0, 2, 2, 0, 1, 1, 2, 0, 0, 2,
           2, 0, 0, 2, 2, 1, 1, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 0, 0, 0, 1, 1,
           0, 2, 2, 2, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 1, 1, 2, 0, 0, 1, 1, 2,
           0, 0, 2, 1, 0, 1, 2, 0, 0, 1, 0, 0, 0, 0, 2, 1, 0, 0, 2, 0, 0, 2,
           0, 0, 2, 0, 0, 1, 2, 2, 2, 1, 1, 2, 0, 0, 1, 1, 0, 0, 2, 0, 0, 0,
           0, 0, 2, 2, 2, 0, 2, 1, 2, 1, 0, 2, 0, 2, 2, 2, 2, 2, 0, 0, 2, 1,
           1, 0, 1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 2, 0, 2, 1, 1, 2, 0,
           2, 2, 1, 0, 2, 2, 2, 2, 0, 2, 0, 0, 1, 1, 1, 2, 1, 0, 2, 0, 2, 0,
           0, 0, 1, 0, 2, 2, 2, 0, 1, 0, 1, 2, 1, 0, 0, 0, 2, 2, 0, 1, 0, 2,
           0, 2, 0, 0, 0, 2, 0, 2, 2, 0, 1, 1, 0, 0, 0, 0, 2, 2, 0, 1, 2, 0,
           2, 0, 2, 2, 0, 2, 1, 2, 0, 2, 0, 0, 0, 0, 2, 0, 2, 1, 0, 0, 0, 0,
           2, 1, 1, 0, 1, 2, 0, 2, 0, 1, 2, 2, 0, 0, 0, 0, 2, 2, 2, 1, 0, 2,
           2, 0, 0, 0, 1, 0, 0, 0, 0, 0, 2, 2, 0, 0, 0, 2, 0, 0, 0, 0, 0, 2,
           0, 0, 2, 0, 0, 2, 1, 0, 0, 0, 2, 0, 0, 2, 0, 1, 2, 2, 0, 2, 2, 0,
           2, 0, 0, 0, 2, 2, 0, 0, 2, 0, 0, 0, 0, 0, 2, 1, 2, 2, 1, 2, 1, 1,
           2, 0, 0, 2, 1, 2, 2, 0, 0, 0, 0, 2, 0, 1, 0, 1, 0, 2, 2, 2, 0, 1,
           0, 0, 2, 0, 0, 0, 0, 2, 2, 0, 0])




```python
df['cluster']=y_predicted
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
      <th>cluster</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>0.271174</td>
      <td>0.014151</td>
      <td>Mr</td>
      <td>2</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>0.472229</td>
      <td>0.139136</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>0.321438</td>
      <td>0.015469</td>
      <td>Miss</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>0.434531</td>
      <td>0.103644</td>
      <td>Mrs</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>0.434531</td>
      <td>0.015713</td>
      <td>Mr</td>
      <td>0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>Montvila, Rev. Juozas</td>
      <td>0.334004</td>
      <td>0.025374</td>
      <td>Other</td>
      <td>0</td>
    </tr>
    <tr>
      <td>887</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>0.233476</td>
      <td>0.058556</td>
      <td>Miss</td>
      <td>2</td>
    </tr>
    <tr>
      <td>888</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>0.271174</td>
      <td>0.045771</td>
      <td>Miss</td>
      <td>2</td>
    </tr>
    <tr>
      <td>889</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>0.321438</td>
      <td>0.058556</td>
      <td>Mr</td>
      <td>0</td>
    </tr>
    <tr>
      <td>890</td>
      <td>Dooley, Mr. Patrick</td>
      <td>0.396833</td>
      <td>0.015127</td>
      <td>Mr</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 5 columns</p>
</div>




```python
km.cluster_centers_
```




    array([[0.40370991, 0.04801379],
           [0.64396415, 0.11667009],
           [0.20482494, 0.05977556]])




```python
df1=df[df.cluster==0]
df2=df[df.cluster==1]
df3=df[df.cluster==2]
plt.scatter(df1.Age,df1['Fare'],color = 'green')
plt.scatter(df2.Age,df2['Fare'],color = 'red')
plt.scatter(df3.Age,df3['Fare'],color = 'black')
plt.xlabel('Age')
plt.ylabel('Fare')
plt.legend()
```

    No handles with labels found to put in legend.





    <matplotlib.legend.Legend at 0x1be66036e88>




![png](output_194_2.png)



```python
df1=df[df.cluster==0]
df2=df[df.cluster==1]
df3=df[df.cluster==2]
plt.scatter(df1['Fare'],df1.Age,color = 'green')
plt.scatter(df2['Fare'],df2.Age,color = 'red')
plt.scatter(df3['Fare'],df3.Age,color = 'black')
plt.ylabel('Age')
plt.xlabel('Fare')
plt.legend()
```

    No handles with labels found to put in legend.





    <matplotlib.legend.Legend at 0x1be65296a08>




![png](output_195_2.png)



```python
k_rng=range(1,10)
sse=[]
for k in k_rng:
    km=KMeans(n_clusters=k)
    km.fit(df[['Age','Fare']])
    sse.append(km.inertia_)
```


```python
sse
```




    [33.163249933113455,
     18.859245724888236,
     13.110890535996486,
     8.754991374324431,
     6.378184765822988,
     5.303403333391413,
     4.352438977975344,
     3.759949542306482,
     3.227046378111474]




```python
plt.xlabel('K')
plt.ylabel('Sum of squared error')
plt.plot(k_rng,sse)
```




    [<matplotlib.lines.Line2D at 0x1be651dcd08>]




![png](output_198_1.png)


# Hierarchical Clustering


```python
import numpy as np
from matplotlib import pyplot as plt
import pandas as pd
```

importing data:


```python
df=pd.read_csv('Unsupervised.csv')
```


```python
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>7.2500</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>71.2833</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>7.9250</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>53.1000</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>8.0500</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>Montvila, Rev. Juozas</td>
      <td>27.0</td>
      <td>13.0000</td>
    </tr>
    <tr>
      <td>887</td>
      <td>Graham, Miss. Margaret Edith</td>
      <td>19.0</td>
      <td>30.0000</td>
    </tr>
    <tr>
      <td>888</td>
      <td>Johnston, Miss. Catherine Helen "Carrie"</td>
      <td>NaN</td>
      <td>23.4500</td>
    </tr>
    <tr>
      <td>889</td>
      <td>Behr, Mr. Karl Howell</td>
      <td>26.0</td>
      <td>30.0000</td>
    </tr>
    <tr>
      <td>890</td>
      <td>Dooley, Mr. Patrick</td>
      <td>32.0</td>
      <td>7.7500</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 3 columns</p>
</div>




```python
df.isnull().sum()

```




    Name      0
    Age     177
    Fare      0
    dtype: int64




```python
df['Initial']=0
for i in df:
    df['Initial']=df.Name.str.extract('([A-Za-z]+)\.') #extracting Name initials

pd.crosstab(df.Initial,train_data.Sex).T.style.background_gradient(cmap='summer_r')


df['Initial'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','Countess',
                               'Jonkheer','Col','Rev','Capt','Sir','Don'],['Miss',
                                'Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)

df.groupby('Initial')['Age'].mean()

df.loc[(df.Age.isnull()) & (df.Initial=='Mr'),'Age']=33
df.loc[(df.Age.isnull()) & (df.Initial=='Mrs'),'Age']=36
df.loc[(df.Age.isnull()) & (df.Initial=='Master'),'Age']=5
df.loc[(df.Age.isnull()) & (df.Initial=='Miss'),'Age']=22
df.loc[(df.Age.isnull()) & (df.Initial=='Other'),'Age']=46
```


```python
df.Age.isnull().any()
```




    False




```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Fare</th>
      <th>Initial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Braund, Mr. Owen Harris</td>
      <td>22.0</td>
      <td>7.2500</td>
      <td>Mr</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
      <td>38.0</td>
      <td>71.2833</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Heikkinen, Miss. Laina</td>
      <td>26.0</td>
      <td>7.9250</td>
      <td>Miss</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
      <td>35.0</td>
      <td>53.1000</td>
      <td>Mrs</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Allen, Mr. William Henry</td>
      <td>35.0</td>
      <td>8.0500</td>
      <td>Mr</td>
    </tr>
  </tbody>
</table>
</div>




```python
X= df.iloc[:,[1,2]].values
```


```python
X
```




    array([[22.    ,  7.25  ],
           [38.    , 71.2833],
           [26.    ,  7.925 ],
           ...,
           [22.    , 23.45  ],
           [26.    , 30.    ],
           [32.    ,  7.75  ]])



Using dendrogram to find the optimal number of clusters


```python
import scipy.cluster.hierarchy as sch
```


```python
dendrogram = sch.dendrogram(sch.linkage(X, method = 'ward'))
```


![png](output_212_0.png)


Fitting hierarchical clustering to the dataset


```python
from sklearn.cluster import AgglomerativeClustering
AgglomerativeClustering()
hc=AgglomerativeClustering(affinity='euclidean', linkage='ward')
y_hc= hc.fit_predict(X)
```


```python
plt.scatter(X[y_hc==0,0], X[y_hc==0,1], s = 100, c= 'red', label='cluster 1')
plt.scatter(X[y_hc==1,0], X[y_hc==1,1], s = 100, c= 'blue', label='cluster 2')
plt.scatter(X[y_hc==2,0], X[y_hc==2,1], s = 100, c= 'green', label='cluster 3')
plt.title('Clusters of Passengers')
plt.xlabel('Age')
plt.ylabel('Fare')
plt.legend()
plt.show()
```


![png](output_215_0.png)


<h3 align="center"> The End </h3>


```python
from IPython.display import Image
Image(url="https://d13ezvd6yrslxm.cloudfront.net/wp/wp-content/images/titanic-jack-rose-door.jpg")
```




<img src="https://d13ezvd6yrslxm.cloudfront.net/wp/wp-content/images/titanic-jack-rose-door.jpg"/>
